% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/unpenalized.R
\name{opti_fct}
\alias{opti_fct}
\title{Core optimizer for TV-VAR likelihood / evaluation}
\usage{
opti_fct(
  params,
  VAR.data,
  Phi.f.mask,
  zero.mean = TRUE,
  Smooth = FALSE,
  purpose = c("optim", "eval"),
  r,
  p,
  n_var
)
}
\arguments{
\item{params}{Numeric vector of unconstrained parameters (see Details).}

\item{VAR.data}{Matrix (T x N).}

\item{Phi.f.mask}{Matrix or array used to indicate nonzero entries of Phi.f
(same shape as Phi.f when reshaped); values != 0 are filled from \code{params}.}

\item{zero.mean}{Logical; if TRUE, intercept is fixed at 0.}

\item{Smooth}{Logical; if TRUE, run Kalman smoother.}

\item{purpose}{"optim" (return negative avg loglik) or "eval" (return list).}

\item{r}{Integer, number of factors.}

\item{p}{Integer, VAR lag order.}

\item{n_var}{Integer, number of VAR variables (ncol(VAR.data)).}
}
\value{
If purpose="optim": scalar negative average loglik.
If purpose="eval": list with likelihoods, states, and components.
}
\description{
Runs the Kalman filter (and optional smoother) and returns the
negative average log-likelihood (for optimization) or detailed
state outputs (for evaluation).
}
\details{
Parameters are unconstrained and mapped internally
(e.g., via \code{plogis}). Nonzero entries of \code{Phi.f} are filled
using \code{Phi.f.mask}.
}
